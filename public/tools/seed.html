<!doctype html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>LearnHub Seeder</title>
    <style>body{font-family:Inter,system-ui,sans-serif;background:#0b0d10;color:#e5e7eb;display:grid;place-items:center;min-height:100vh} .card{background:#111418;border:1px solid #1b212a;border-radius:12px;padding:16px;max-width:560px} .btn{padding:10px 12px;border-radius:12px;border:1px solid #1b212a;background:#60a5fa;color:#0b0d10;font-weight:700;cursor:pointer}</style>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  </head>
  <body>
    <div class="card">
      <h2>Seed Sample Data</h2>
      <p>This uses the same Firebase project as your app.</p>
      <button class="btn" id="seed">Seed</button>
      <div style="margin-top:8px;font-size:12px;color:#9aa4b2">Tip: make sure youâ€™re signed-in in the main app tab.</div>
    </div>
    <script>
      (function(){
        try{
          window.__FIREBASE_CONFIG = JSON.parse(localStorage.getItem('__FIREBASE_CONFIG')||'{}');
        }catch{}
        if(!window.__FIREBASE_CONFIG || !__FIREBASE_CONFIG.projectId) alert('Config missing. Open the main app once to store config.');
        firebase.initializeApp(window.__FIREBASE_CONFIG);
        const auth=firebase.auth(), db=firebase.firestore();
        document.getElementById('seed').onclick=async ()=>{
          const u=auth.currentUser; if(!u){ alert('Sign in first in the main app tab.'); return; }
          const col=(n)=>db.collection(n);
          const outline=[{title:'Ch.1',lessons:[{title:'Intro',html:'<p>Hello!</p>'}]}];
          const c=await col('courses').add({title:'Sample Course',category:'General',desc:'Demo content',outline,ownerUid:u.uid,ownerEmail:u.email,createdAt:firebase.firestore.FieldValue.serverTimestamp()});
          await col('enrollments').add({uid:u.uid,courseId:c.id,createdAt:firebase.firestore.FieldValue.serverTimestamp(),course:{id:c.id,title:'Sample Course',category:'General'}});
          await col('quizzes').add({title:'Sample Quiz',courseId:c.id,courseTitle:'Sample Course',passScore:70,items:[{q:'2+2?',type:'single',choices:['3','4','5'],answer:1}],ownerUid:u.uid,createdAt:firebase.firestore.FieldValue.serverTimestamp()});
          alert('Seeded.');
        };
      })();
    </script>
  </body>
</html>