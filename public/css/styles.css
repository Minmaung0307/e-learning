:root{
  --bg:#0b0d10; --panel:#0f1216; --card:#12161c; --text:#e7edf3; --muted:#95a3b8;
  --accent:#7ad3ff; --accent-weak:#0f2a3a; --border:#1e2430;
  --ok:#10b981; --warn:#f59e0b; --danger:#ef4444;
  --shadow:0 6px 24px rgba(0,0,0,.35);
  --radius:14px;
}
*{box-sizing:border-box}
html,body{margin:0;height:100%;background:linear-gradient(180deg,#0b0d10,#0c1626)}
body{color:var(--text);font:14px/1.4 Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Apple Color Emoji,Noto Color Emoji,EmojiOne Color}

a{color:var(--accent);text-decoration:none}
.muted{color:var(--muted)}

.app{display:grid;grid-template-columns:280px 1fr;min-height:100vh}
.sidebar{background:rgba(13,20,34,.82);backdrop-filter:blur(12px);border-right:1px solid var(--border);display:flex;flex-direction:column;min-height:100vh}
.sidebar .brand{display:flex;align-items:center;gap:10px;padding:14px 16px;border-bottom:1px solid var(--border)}
.logo{width:36px;height:36px;border-radius:10px;overflow:hidden;background:#0c1626;display:grid;place-items:center}
.logo img{width:100%;height:100%;object-fit:cover}
.brand .title{font-weight:800;letter-spacing:.3px}

.nav{padding:8px}
.nav .item{display:flex;gap:10px;align-items:center;padding:10px 12px;border-radius:10px;color:#d7e3f0;cursor:pointer}
.nav .item:hover{background:#121a28}
.nav .item.active{background:#142236;border:1px solid #1f334d}
.nav .item.hidden{display:none}

.footer{margin-top:auto;padding:10px 12px;border-top:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.topbar{position:sticky;top:0;z-index:4;display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 14px;background:rgba(11,13,16,.7);backdrop-filter:blur(12px);border-bottom:1px solid var(--border)}
.badge{background:#111827;border:1px solid #1f2937;border-radius:999px;padding:6px 10px;color:#cdd7e3;font-weight:700}

.main{padding:14px;min-height:calc(100vh - 52px)}
.grid{display:grid;gap:12px}
.grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
.grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
.grid.cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow)}
.card-body{padding:12px}
.card.clickable{cursor:pointer}
.card.highlight{background:linear-gradient(180deg,#0f2030,#0f2a3a);outline:2px solid #1f3852}

.table-wrap{overflow:auto;border:1px solid var(--border);border-radius:12px}
table{width:100%;border-collapse:separate;border-spacing:0}
th,td{padding:8px 10px;border-bottom:1px solid var(--border)}
th{text-align:left;color:#bdd1e6;white-space:nowrap}
td.num{text-align:right}
.tr-total th{position:sticky;bottom:-1px;background:#0e131b}

.input{background:#0d1522;border:1px solid #1f2a3a;color:#cfe3f6;border-radius:10px;padding:8px 10px;outline:none}
.input:focus{border-color:#2d8dbe;box-shadow:0 0 0 3px rgba(47,152,206,.18)}

.btn{background:#1e2a3f;border:1px solid #2a3a54;border-radius:10px;color:#d8e7f7;padding:8px 12px;cursor:pointer}
.btn:hover{filter:brightness(1.03)}
.btn.ghost{background:transparent;border:1px solid #263449}
.btn.secondary{background:linear-gradient(90deg,#2cc5e3,#7ad3ff);color:#071018;border:none}
.btn.ok{background:#123026;border:1px solid #1b4d3d}
.btn.danger{background:#321213;border:1px solid #4f1b1c}

.search-inline{flex:1;max-width:520px;position:relative}
.search-results{position:absolute;left:0;right:0;top:calc(100% + 6px);background:#0f1623;border:1px solid #223147;border-radius:12px;display:none;max-height:300px;overflow:auto;box-shadow:var(--shadow);z-index:10}
.search-results.active{display:block}
.search-results .row{padding:8px 10px;cursor:pointer}
.search-results .row:hover{background:#121a28}

.notification{position:fixed;left:50%;top:14px;transform:translateX(-50%);background:#0f1a2a;border:1px solid #21314a;padding:8px 12px;border-radius:10px;opacity:0;pointer-events:none;transition:.25s;z-index:99}
.notification.show{opacity:1}
.notification.warn{border-color:#7c5d1c}
.notification.danger{border-color:#6b1d1e}
.notification.ok{border-color:#1f4d3d}

.modal{position:fixed;inset:0;display:none;place-items:center;z-index:50}
.modal.active{display:grid}
.modal .dialog{width:min(820px,96vw);max-height:90vh;overflow:auto;background:#0f141c;border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow)}
.modal .head{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--border)}
.modal .body{padding:12px}
.modal .foot{padding:12px;border-top:1px solid var(--border);display:flex;gap:8px;justify-content:flex-end}
.modal-backdrop{position:fixed;inset:0;background:rgba(5,6,8,.55);backdrop-filter:blur(4px);display:none;z-index:40}
.modal-backdrop.active{display:block}

.backdrop{position:fixed;inset:0;background:rgba(0,0,0,.35);backdrop-filter:blur(2px);display:none;z-index:6}
.backdrop.active{display:block}

.lane-row.drop{outline:2px dashed #2d8dbe}
.task-card.dragging{opacity:.6}

@media (max-width: 980px){
  .app{grid-template-columns:0 1fr}
  .sidebar{position:fixed;left:0;top:0;bottom:0;width:82vw;max-width:320px;transform:translateX(-100%);transition:.25s;z-index:7}
  body.sidebar-open .sidebar{transform:translateX(0)}
  .grid.cols-4{grid-template-columns:repeat(2,minmax(0,1fr))}
  .grid.cols-3{grid-template-columns:repeat(2,minmax(0,1fr))}
}
@media (max-width: 640px){
  .grid.cols-2{grid-template-columns:1fr}
  .grid.cols-3{grid-template-columns:1fr}
  .grid.cols-4{grid-template-columns:1fr}
}